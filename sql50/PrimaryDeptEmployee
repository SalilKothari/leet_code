# Write your MySQL query statement below
WITH counts AS (
    SELECT
        employee_id,
        department_id,
        primary_flag,
        COUNT(*) OVER (PARTITION BY employee_id) AS dept_count
    FROM Employee
)

SELECT 
    employee_id,
    department_id
FROM counts
WHERE dept_count = 1 OR primary_flag = 'Y';


# solution 2
(SELECT employee_id, department_id
FROM Employee
GROUP BY employee_id
HAVING COUNT(*) = 1)

UNION 

(SELECT employee_id, department_id
FROM Employee
WHERE primary_flag = 'Y')
